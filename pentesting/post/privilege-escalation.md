# Privilege Escalation

### System Enumeration

* `hostname` will return the hostname of the target machine
* `uname -a` Will print system information
* `cat /proc/version` provides information about the target system processes
* `echo $PATH`
* By using [**pspy**](https://github.com/DominicBreuker/pspy), we can fetch processes without root privileges `./pspy64 -pf -i 1000`
* Find open ports with `netstat -punta`
* Filter only LISTEN ports `netstat -punta | grep -i listen`





#### Find

```bash
# Find SSH keys
find / -name authorized_keys 2> /dev/null or find / -name id_rsa 2> /dev/null
```

```bash
# Search for writable directories
find / -writable 2>/dev/null | cut -d "/" -f 2,3 | sort -u

# System service files
find / -writable -name "*.service" 2>/dev/null
```



#### Wildcard Abuse

```bash
find / -name "*.txt" 2>/dev/null
find /opt -name "*.txt" 2>/dev/null
find / -name "passwd" 2>/dev/null
find / -name "authorized_keys" 2>/dev/null
find / -name "users" 2>/dev/null
find / -name "*user*" 2>/dev/null
find / -name "secret.key" -or -name "secret" 2>/dev/null
find / -name "credential*.txt" 2>/dev/null
find / -name "*secret*" -or -name "*credential*" 2>/dev/null
find / -name "*root*" -or -name "*password*" 2>/dev/null
find / -name "*.key" -or -name "*.db" 2>/dev/null
find / -name "*data*" 2>/dev/null
find / -name ".env" 2>/dev/null
find / -name "*flag*" 2>/dev/null

# SQL files
find / -name "*.sql" 2>/dev/null
strings example.sql

# Backup files may contain sensitive information
find / -name "*backup*" 2>/dev/null
find / -name "*.bak*" 2>/dev/null
find / -name "*.back*" 2>/dev/null
find / -name "*.old" 2>/dev/null

# Histories
find / -name "*history*" 2>/dev/null

# Backup files for /etc/shadow.
# ex. /var/shadow.bak
find / -name *shadow* 2>/dev/null

# Kerberos
find / -name "*.keytab" 2>/dev/null

# We can exclude specific directory with -not -path option of find command.
find / -name "*.txt" -not -path "/usr/share" 2>/dev/null

# ----------------------------------------
# Find more faster than `find` command.
locate data
locate flag
locate flag*.txt
locate *flag*
locate password
locate *password*
locate *save*
locate *save.txt
locate user.txt
locate user*
locate *user*
locate root.txt
locate *root*
locate .db
locate .txt
```

### SUID bit

```bash
# SUID
find / -type f -perm -u=s 2>/dev/null
find / -type f -perm -04000 2>/dev/null
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null

# SGID
find / -type f -perm -g=s 2>/dev/null
find / -type f -perm -02000 2>/dev/null
find / -user root -perm -2000 -exec ls -ldb {} \; 2>/dev/null
```

### Capabilities

```bash
# To find files that are set capabilities.
getcap -r / 2>/dev/null
```





### Best Resources

1. [**GTFOBins**](https://gtfobins.github.io/)
2. [**HackTricks**](https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist)
3. [**Exploit Notes**](https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/)

### Automated Scripts

1. [**Linpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite)
2. [**LinEnum**](https://github.com/rebootuser/LinEnum)
3. [**Linux Exploit Suggester**](https://github.com/mzet-/linux-exploit-suggester)
4. [**Linux Priv Checker**](https://github.com/sleventyeleven/linuxprivchecker)
